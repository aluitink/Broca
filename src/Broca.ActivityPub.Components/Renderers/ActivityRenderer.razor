@using KristofferStrube.ActivityStreams
@inherits ComponentBase

@* Render only the inner objects without the activity wrapper *@
@if (Activity != null)
{
    @if (ShowObjects && Activity.Object?.Any() == true)
    {
        @foreach (var obj in Activity.Object)
        {
            @if (ObjectRenderer != null)
            {
                @ObjectRenderer(obj)
            }
            else
            {
                <ObjectDisplay Object="@obj" 
                             ShowMissingRenderer="@ShowMissingRenderer"
                             AutoResolveLinks="true" />
            }
        }
    }
    else if (ShowEmptyState)
    {
        <div class="activitypub-activity-empty @CssClass">
            <div class="empty-state">
                <p>No content available</p>
                @if (Activity.Type?.Any() == true)
                {
                    <span class="activity-type-badge">@Activity.Type.First()</span>
                }
            </div>
        </div>
    }

    @if (AdditionalContent != null)
    {
        @AdditionalContent(Activity)
    }
}

@code {
    /// <summary>
    /// Gets or sets the Activity to render.
    /// </summary>
    [Parameter]
    public Activity? Activity { get; set; }

    /// <summary>
    /// Gets or sets whether to show an empty state when no objects are present.
    /// </summary>
    [Parameter]
    public bool ShowEmptyState { get; set; } = false;

    /// <summary>
    /// Gets or sets whether to show objects.
    /// </summary>
    [Parameter]
    public bool ShowObjects { get; set; } = true;

    /// <summary>
    /// Gets or sets whether to show a message when no renderer is available for objects.
    /// </summary>
    [Parameter]
    public bool ShowMissingRenderer { get; set; } = false;

    /// <summary>
    /// Gets or sets additional CSS classes.
    /// </summary>
    [Parameter]
    public string? CssClass { get; set; }

    /// <summary>
    /// Gets or sets a custom renderer for objects.
    /// </summary>
    [Parameter]
    public RenderFragment<object>? ObjectRenderer { get; set; }

    /// <summary>
    /// Gets or sets additional content to render.
    /// </summary>
    [Parameter]
    public RenderFragment<Activity>? AdditionalContent { get; set; }
}
